<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ß–∞—Ç + –¢–∞–π–º–µ—Ä</title>
  <style>
    body { font-family: Arial; text-align: center; margin: 20px; background: #222; color: #fff; }
    .comments { background: rgba(0,0,0,0.5); padding: 15px; border-radius: 10px; max-width: 500px; margin: 20px auto; }
    input, textarea, button { width: 100%; margin: 5px 0; padding: 8px; border-radius: 5px; border: none; }
    button { background: #ffeb3b; cursor: pointer; }
    .comment { text-align: left; background: rgba(255,255,255,0.1); padding: 5px; margin: 5px 0; border-radius: 5px; }
  </style>
</head>
<body>

<h2>–ß–∞—Ç</h2>

<div class="comments">
  <input id="name" placeholder="–ò–º—è">
  <textarea id="text" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
  <button onclick="sendComment()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  <div id="list"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";

  // üî¥ –í—Å—Ç–∞–≤—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyDbAvcfYcB4aQ9xp9-TtefPZ_ibOyGCDiY",
    authDomain: "zsuero-bot.firebaseapp.com",
    databaseURL: "https://zsuero-bot-default-rtdb.firebaseio.com",
    projectId: "zsuero-bot"
  };
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const commentsRef = ref(db, "comments");

  window.sendComment = () => {
    const name = document.getElementById("name").value.trim();
    const text = document.getElementById("text").value.trim();
    if (!name || !text) return;

    push(commentsRef, { name, text, time: Date.now() });
    document.getElementById("text").value = "";
  };

  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  onValue(commentsRef, snapshot => {
    const list = document.getElementById("list");
    list.innerHTML = "";

    const arr = [];
    snapshot.forEach(child => arr.push(child.val()));

    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    arr.sort((a, b) => a.time - b.time);

    arr.forEach(c => {
      const div = document.createElement("div");
      div.className = "comment";
      div.innerHTML = `<b>${c.name}:</b> ${c.text}`;
      list.appendChild(div);
    });

    // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
    list.scrollTop = list.scrollHeight;
  });
</script>

</body>
</html>
